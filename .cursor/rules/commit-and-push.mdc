---
description: Commit all changes and push to remote
globs:
alwaysApply: false
---

# Commit and Push

When the user asks to "commit and push" (or similar), follow these steps:

1. **Gather context** — run these three commands in parallel:
   - `git status` to see all staged, unstaged, and untracked files
   - `git diff` to see the full diff of changes (staged + unstaged)
   - `git log --oneline -5` to see recent commit messages for style reference

2. **Review the changes** — analyze the diff and untracked files:
   - Summarize what changed and why
   - Check for files that should NOT be committed (`.env`, credentials, secrets, large binaries, debug `console.log` statements)
   - If anything looks risky, warn the user before proceeding

3. **Write a good commit message** following the project's existing style:
   - Short lowercase summary line (imperative mood, e.g. "add…", "fix…", "update…")
   - Optional blank line + 1-2 sentence body if the change is non-trivial
   - Use a HEREDOC to pass the message to `git commit`

4. **Stage, commit, and push** in a single sequential command:
   ```bash
   git add -A && git commit -m "$(cat <<'EOF'
   summary line here

   Optional body here.
   EOF
   )" && git push
   ```

5. **Report the result** — show the short SHA and confirm it was pushed.

## Rules

- NEVER commit `.env` files, API keys, or secrets. Warn the user if they are present.
- NEVER force-push unless the user explicitly asks.
- NEVER amend a commit that has already been pushed.
- NEVER update git config.
- If there are no changes to commit, say so and stop.
